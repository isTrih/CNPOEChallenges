<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<!--
	░░░░█─────────────█──▀──
	░░░░▓█───────▄▄▀▀█──────
	░░░░▒░█────▄█▒░░▄░█─────
	░░░░░░░▀▄─▄▀▒▀▀▀▄▄▀──DO─
	░░░░░░░░░█▒░░░░▄▀────IT──
	▒▒▒░░░░▄▀▒░░░░▄▀───FOR──
	▓▓▓▓▒░█▒░░░░░█▄───BILLY──
	█████▀▒░░░░░█░▀▄────────
	█████▒▒░░░▒█░░░▀▄───────
	███▓▓▒▒▒▀▀▀█▄░░░░█──────
	▓██▓▒▒▒▒▒▒▒▒▒█░░░░█─────
	▓▓█▓▒▒▒▒▒▒▓▒▒█░░░░░█────
	░▒▒▀▀▄▄▄▄█▄▄▀░░░░░░░█─
	-->
	<META NAME="ROBOTS" CONTENT="noarchive">
	<meta name="Description" content="Path of Exile Challenge Guide">
	<meta name="Keywords" content="path of exile, challenge guide">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script> 
	<script src="./js/showdown.min.js"></script>
	<title>Path of Exile Settlers of Kalguur Challenge Guide</title>
	<style>
	:root{--toggle-left:340px;--sidebar-left:0px;}
	[data-sidebar="visible"]{--toggle-left:4px;--sidebar-left: -336px;}
	*{font-family:Verdana,Arial,Helvetica,sans-serif;box-sizing: border-box;}
	html{background:#363636;text-shadow: 2px 2px 1px rgba(0,0,0,0.75);}
	a,a:visited{color:#EE983C;text-decoration:none;}
	a:hover{color:#FDB12D;}
	h1{color:#E7B477;text-align:center;border-left:5px solid #C2A965;border-right:5px solid #C2A965;border-top:1px solid #C2A965;border-bottom:1px solid #C2A965;background-color:#5d1515;margin-bottom:0px;padding:5px;position:relative;}
	h2{color:#DADADA;text-align:center;margin:4px 0px;}
	h3{color:#875516;text-align:center;margin:4px 0px;}
	body{color:rgb(230,230,210);margin: 0 0 20px;padding-bottom:20px;}
	#contents{margin:auto;max-width:800px;}
	h2[id^="veryeasy"]{color:#00DA00}
	h2[id^="easy"]{color:#56C256}
	h2[id^="average"]{color:#A5B2C2}
	h2[id^="hard"]{color:#D96865}
	h2[id^="veryhard"]{color:#D81400}
	h3[id^="grindheavy"]{color:#00C6D8;font-size:75%;}
	h3[id^="partiallybuyable"],h3[id^="buyable"],h3[id^="luckbased"]{color:#00C6D8;font-size:75%;margin:2px 0px;}
	em img,li img{max-height:18px;margin-bottom:-3px;}
	#footer{position: fixed;left:0;bottom:0;height:30px;width:100%;text-align:center;background:#292929;border-top:1px solid black;padding-top:5px;}
	#navigation{position:fixed;left:var(--sidebar-left);top:0px;height:100vh;display:var(--sidebar-display);max-height:100vh;overflow-y:scroll;background:rgb(40,40,40);padding-right:10px;width:336px;transition:all 0.2s linear;}
	#toggle{position:fixed;left:var(--toggle-left);top:5px;cursor:pointer;transition: all 0.2s linear;font-size:30px;padding-bottom: 20px;color:#ffff00;text-shadow: 2px 2px 4px rgb(0, 0, 0, 1);}
	#toggle:hover{color:#FFE28B}
	.ggg{color:#E7B477;}
	.com{color:rgb(230,230,210);}
	li{line-height:120%;}
	.complete{position:absolute;right:0;top:0;cursor:hand;cursor:pointer;width:48px;height:48px;}
	div[data-complete="no"]{color:red;}
	div[data-complete="yes"]{color:rgb(0,240,0);}
	
	</style>
	</head>
<body>
	<div id="toggle" onclick="switchSidebar()">☰</div>
	<div id="navigation"></div>
	<div id="contents"></div>
	<div id="footer">
	<a href="#" onclick="getLeague('settlers');return false;">Settlers Guide</a> | <a href="#" onclick="getLeague('necropolis');return false;">Necropolis Guide</a> | <a href="#" onclick="getLeague('affliction');return false;">Affliction Guide</a>
	</div>
	<script>
		var currentLeague = "settlers";
		function getLeague(league){		
			var converter = new showdown.Converter();
			// Declare extension
			var customClassExt = {
				type: 'output',
				filter: function (text) {
					return text
						.replace(/<(.+)>\[\.([a-z0-9A-Z\s]+)\]/g, `<$1 class="$2">`)
						.replace(/class="(.+)"/g, function (str) {
							if (str.indexOf("<em>") !== -1) {
								return str.replace(/<[/]?em>/g, '_');
							}
							return str;
						});
				}
			};
			// Add extension to converter
			converter.addExtension(customClassExt);
						
			$.ajax({
				url: league + '-toc.txt',
				success: function(data){ document.getElementById("navigation").innerHTML = converter.makeHtml(data);}
			});
			
			$.ajax({
				url:league + '.txt',
				success: function(data){ 
					$("#contents").html(converter.makeHtml(data));
					if (location.hash) {
						let target = location.hash;				
						$('html, body').animate({scrollTop: $(target).offset().top}, 'fast');
						
						if(league == currentLeague){
							addCheckboxes();
						}
					}
				}
			});
		}	
		function switchSidebar(e) {
			let sidebar = localStorage.getItem("data-sidebar");
			if (sidebar === "visible" || sidebar === null) {
				localStorage.setItem("data-sidebar", "hidden");
				document.documentElement.setAttribute('data-sidebar', 'hidden');
			} else {
				localStorage.setItem("data-sidebar", "visible");
				document.documentElement.setAttribute('data-sidebar', 'visible');
			}
		}
		
		function getSidebar(){
			let sidebar = localStorage.getItem("data-sidebar");
			if (sidebar === "visible" || sidebar === null) {
				localStorage.setItem("data-sidebar", "visible");
				document.documentElement.setAttribute('data-sidebar', 'visible');
			} else {
				localStorage.setItem("data-sidebar", "hidden");
				document.documentElement.setAttribute('data-sidebar', 'hidden');
			}
		}
		
		function addCheckboxes(){
			$("h1").each(function(i){
				if(i != 0 && i < 40){
					let challenge = localStorage.getItem("data-ch-" + i);
					if (challenge === "no" || challenge === null) {
						localStorage.setItem("data-ch-" + i, "no");
						$(this).append('<div class="complete" data-challenge="' + i + '" data-complete="no">&#x2717;</div>');
					} else if (challenge === "yes") {
						$(this).append('<div class="complete" data-challenge="' + i + '" data-complete="yes">&#x2713;</div>');
						$("#ch-" + i).hide();		
					}					
				}
			})
		}
		$(document).on('click', '.complete', function() {
			let i = $(this).attr("data-challenge");
			let challenge = localStorage.getItem("data-ch-" + i);
			
			if (challenge === "yes" || challenge === null) {
				localStorage.setItem("data-ch-" + i, "no");
				$(this).html('&#x2717;').attr("data-complete", "no");
				$("#ch-" + i).show();
			} else if (challenge === "no") {
				localStorage.setItem("data-ch-" + i, "yes");
				$(this).html('&#x2713;').attr("data-complete", "yes");
				$("#ch-" + i).hide();
			}
		});
		getSidebar();
		getLeague("settlers");
		
		
	</script>
</body>
</html>